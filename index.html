<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sayonara AI - Next-Gen Chatbot Experience</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', system-ui, sans-serif;
        }

        /* Glassmorphism effects */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-dark {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Gradient animations */
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .animated-gradient {
            background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #f5576c, #4facfe, #00f2fe);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }

        /* Message animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-enter {
            animation: slideInUp 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Typing indicator */
        @keyframes bounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .typing-dot {
            animation: bounce 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        /* Scrollbar styling */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #667eea, #764ba2);
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #764ba2, #667eea);
        }

        /* Glow effects */
        .glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4),
                        0 0 40px rgba(102, 126, 234, 0.2);
        }

        .glow-hover {
            transition: all 0.3s ease;
        }

        .glow-hover:hover {
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6),
                        0 0 60px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }

        /* Code block styling */
        .code-block {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            padding: 16px;
            position: relative;
            font-family: 'Fira Code', monospace;
        }

        /* Pulse animation for new message notification */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Shimmer effect for loading */
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, createContext, useContext } = React;

        // Theme Context
        const ThemeContext = createContext();
        
        const ThemeProvider = ({ children }) => {
            const [isDark, setIsDark] = useState(true);
            
            useEffect(() => {
                const saved = localStorage.getItem('theme');
                setIsDark(saved === 'dark' || saved === null);
            }, []);
            
            const toggleTheme = () => {
                const newTheme = !isDark;
                setIsDark(newTheme);
                localStorage.setItem('theme', newTheme ? 'dark' : 'light');
            };
            
            return (
                <ThemeContext.Provider value={{ isDark, toggleTheme }}>
                    {children}
                </ThemeContext.Provider>
            );
        };

        // Mock API Service
        const api = {
            async sendMessage(conversationId, message) {
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const responses = [
                    "I've analyzed your data wiping requirements. The Sayonara platform offers military-grade sanitization with blockchain verification.",
                    "Our dual-phase sanitization process ensures complete data erasure, meeting NIST 800-88 standards.",
                    "The AI guidance system can help troubleshoot any wiping issues in real-time.",
                    "Each wipe generates a tamper-proof certificate stored on the blockchain for compliance.",
                ];
                
                return {
                    messageId: Date.now(),
                    content: responses[Math.floor(Math.random() * responses.length)],
                    done: true
                };
            },
            
            async getConversations() {
                await new Promise(resolve => setTimeout(resolve, 300));
                return [
                    { id: 'c1', title: 'Project Setup Help', lastMessage: 'Use /summarize for quick overview', unread: 2, updatedAt: new Date().toISOString() },
                    { id: 'c2', title: 'Data Wiping Process', lastMessage: 'NIST standards implemented', unread: 0, updatedAt: new Date().toISOString() },
                    { id: 'c3', title: 'Blockchain Integration', lastMessage: 'Certificates deployed on Sepolia', unread: 1, updatedAt: new Date().toISOString() },
                ];
            },
            
            streamMessage(conversationId, message, onChunk) {
                const fullResponse = "I'm streaming this response to demonstrate the real-time capabilities of the Sayonara chatbot. Each token appears progressively, creating a smooth, engaging user experience.";
                const words = fullResponse.split(' ');
                let index = 0;
                
                const interval = setInterval(() => {
                    if (index < words.length) {
                        onChunk(words.slice(0, index + 1).join(' '));
                        index++;
                    } else {
                        clearInterval(interval);
                        onChunk(fullResponse, true);
                    }
                }, 100);
                
                return () => clearInterval(interval);
            }
        };

        // Icons Component
        const Icon = ({ name, className = "" }) => {
            const icons = {
                send: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>,
                moon: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>,
                sun: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
                plus: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>,
                search: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>,
                copy: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>,
                menu: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" /></svg>,
                close: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
                attachment: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" /></svg>,
                emoji: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
                settings: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
            };
            return icons[name] || null;
        };

        // Typing Indicator Component
        const TypingIndicator = () => (
            <div className="flex items-center space-x-1 p-4 glass rounded-2xl max-w-[100px]">
                <div className="w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full typing-dot"></div>
                <div className="w-2 h-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full typing-dot"></div>
                <div className="w-2 h-2 bg-gradient-to-r from-pink-500 to-indigo-500 rounded-full typing-dot"></div>
            </div>
        );

        // Message Component
        const Message = ({ message, isUser }) => {
            const [copied, setCopied] = useState(false);
            const [reaction, setReaction] = useState(null);
            
            const handleCopy = () => {
                navigator.clipboard.writeText(message.content);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };
            
            const handleReaction = (emoji) => {
                setReaction(emoji);
            };
            
            return (
                <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} message-enter group`}>
                    <div className={`relative max-w-[85%] lg:max-w-[70%] ${isUser ? 'order-1' : ''}`}>
                        <div className={`rounded-2xl px-4 py-3 ${
                            isUser 
                                ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg glow-hover' 
                                : 'glass-dark text-gray-100'
                        }`}>
                            <p className="text-sm md:text-base leading-relaxed">{message.content}</p>
                            {message.timestamp && (
                                <p className="text-xs opacity-70 mt-1">
                                    {new Date(message.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                </p>
                            )}
                        </div>
                        
                        {/* Action buttons */}
                        <div className={`absolute ${isUser ? 'left-0' : 'right-0'} -bottom-6 opacity-0 group-hover:opacity-100 transition-opacity flex space-x-2`}>
                            <button 
                                onClick={handleCopy}
                                className="text-gray-400 hover:text-white transition-colors"
                                title="Copy message"
                            >
                                {copied ? '✓' : <Icon name="copy" className="w-4 h-4" />}
                            </button>
                            <div className="flex space-x-1">
                                {['❤️', '👍', '😂'].map(emoji => (
                                    <button
                                        key={emoji}
                                        onClick={() => handleReaction(emoji)}
                                        className={`text-sm hover:scale-125 transition-transform ${
                                            reaction === emoji ? 'scale-125' : ''
                                        }`}
                                    >
                                        {emoji}
                                    </button>
                                ))}
                            </div>
                        </div>
                        
                        {reaction && (
                            <div className="absolute -bottom-2 -right-2 bg-gray-800 rounded-full px-2 py-1 text-xs">
                                {reaction}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Quick Reply Component
        const QuickReplies = ({ replies, onSelect }) => (
            <div className="flex flex-wrap gap-2 px-4 py-2">
                {replies.map((reply, index) => (
                    <button
                        key={index}
                        onClick={() => onSelect(reply)}
                        className="px-4 py-2 rounded-full glass hover:bg-white/10 text-white text-sm transition-all hover:scale-105 border border-white/20"
                    >
                        {reply}
                    </button>
                ))}
            </div>
        );

        // Sidebar Component
        const Sidebar = ({ conversations, onSelectConversation, selectedId, isOpen, onClose }) => {
            const [searchTerm, setSearchTerm] = useState('');
            const { isDark } = useContext(ThemeContext);
            
            const filteredConversations = conversations.filter(conv => 
                conv.title.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            return (
                <div className={`${isOpen ? 'translate-x-0' : '-translate-x-full'} lg:translate-x-0 fixed lg:relative inset-y-0 left-0 w-80 glass-dark z-40 transition-transform duration-300`}>
                    <div className="h-full flex flex-col">
                        {/* Header */}
                        <div className="p-4 border-b border-white/10">
                            <div className="flex items-center justify-between mb-4">
                                <h2 className="text-xl font-bold text-white">Conversations</h2>
                                <button
                                    onClick={onClose}
                                    className="lg:hidden text-white/60 hover:text-white"
                                >
                                    <Icon name="close" className="w-6 h-6" />
                                </button>
                            </div>
                            
                            {/* Search */}
                            <div className="relative">
                                <Icon name="search" className="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
                                <input
                                    type="text"
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    placeholder="Search conversations..."
                                    className="w-full pl-10 pr-4 py-2 rounded-lg glass bg-white/5 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"
                                />
                            </div>
                            
                            {/* New Chat Button */}
                            <button className="w-full mt-3 px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-medium hover:from-indigo-700 hover:to-purple-700 transition-all hover:scale-105 flex items-center justify-center space-x-2 glow">
                                <Icon name="plus" className="w-5 h-5" />
                                <span>New Chat</span>
                            </button>
                        </div>
                        
                        {/* Conversations List */}
                        <div className="flex-1 overflow-y-auto custom-scrollbar">
                            {filteredConversations.map(conv => (
                                <div
                                    key={conv.id}
                                    onClick={() => {
                                        onSelectConversation(conv.id);
                                        if (window.innerWidth < 1024) onClose();
                                    }}
                                    className={`p-4 border-b border-white/5 cursor-pointer transition-all hover:bg-white/5 ${
                                        selectedId === conv.id ? 'bg-white/10 border-l-4 border-purple-500' : ''
                                    }`}
                                >
                                    <div className="flex justify-between items-start mb-1">
                                        <h3 className="font-semibold text-white">{conv.title}</h3>
                                        {conv.unread > 0 && (
                                            <span className="px-2 py-1 text-xs rounded-full bg-purple-600 text-white pulse">
                                                {conv.unread}
                                            </span>
                                        )}
                                    </div>
                                    <p className="text-sm text-gray-400 truncate">{conv.lastMessage}</p>
                                    <p className="text-xs text-gray-500 mt-1">
                                        {new Date(conv.updatedAt).toLocaleDateString()}
                                    </p>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Right Panel Component
        const RightPanel = ({ isOpen, onClose }) => {
            const { isDark, toggleTheme } = useContext(ThemeContext);
            
            return (
                <div className={`${isOpen ? 'translate-x-0' : 'translate-x-full'} fixed lg:relative inset-y-0 right-0 w-80 glass-dark z-40 transition-transform duration-300`}>
                    <div className="h-full flex flex-col p-4">
                        {/* Header */}
                        <div className="flex items-center justify-between mb-6">
                            <h2 className="text-xl font-bold text-white">Settings</h2>
                            <button
                                onClick={onClose}
                                className="lg:hidden text-white/60 hover:text-white"
                            >
                                <Icon name="close" className="w-6 h-6" />
                            </button>
                        </div>
                        
                        {/* Theme Toggle */}
                        <div className="mb-6">
                            <div className="flex items-center justify-between p-4 rounded-lg glass">
                                <span className="text-white font-medium">Dark Mode</span>
                                <button
                                    onClick={toggleTheme}
                                    className="relative w-14 h-7 rounded-full bg-gray-700 transition-colors"
                                >
                                    <div className={`absolute top-1 ${isDark ? 'left-8' : 'left-1'} w-5 h-5 bg-white rounded-full transition-all`}></div>
                                </button>
                            </div>
                        </div>
                        
                        {/* Model Info */}
                        <div className="mb-6">
                            <h3 className="text-sm font-semibold text-gray-400 mb-3">AI Model</h3>
                            <div className="p-4 rounded-lg glass">
                                <div className="flex items-center space-x-2 mb-2">
                                    <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span className="text-white font-medium">Gemini 2.5 Flash</span>
                                </div>
                                <p className="text-xs text-gray-400">RAG Enhanced • Blockchain Verified</p>
                            </div>
                        </div>
                        
                        {/* Features */}
                        <div className="mb-6">
                            <h3 className="text-sm font-semibold text-gray-400 mb-3">Features</h3>
                            <div className="space-y-2">
                                <div className="p-3 rounded-lg glass">
                                    <p className="text-sm text-white">✨ Dual-phase sanitization</p>
                                </div>
                                <div className="p-3 rounded-lg glass">
                                    <p className="text-sm text-white">🔐 NIST 800-88 compliant</p>
                                </div>
                                <div className="p-3 rounded-lg glass">
                                    <p className="text-sm text-white">⛓️ Blockchain certificates</p>
                                </div>
                            </div>
                        </div>
                        
                        {/* Keyboard Shortcuts */}
                        <div className="mt-auto">
                            <h3 className="text-sm font-semibold text-gray-400 mb-3">Shortcuts</h3>
                            <div className="space-y-2 text-xs">
                                <div className="flex justify-between text-gray-400">
                                    <span>New Chat</span>
                                    <kbd className="px-2 py-1 rounded bg-gray-700 text-white">Ctrl+N</kbd>
                                </div>
                                <div className="flex justify-between text-gray-400">
                                    <span>Search</span>
                                    <kbd className="px-2 py-1 rounded bg-gray-700 text-white">Ctrl+K</kbd>
                                </div>
                                <div className="flex justify-between text-gray-400">
                                    <span>Send</span>
                                    <kbd className="px-2 py-1 rounded bg-gray-700 text-white">Ctrl+Enter</kbd>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Composer Component
        const Composer = ({ onSend }) => {
            const [message, setMessage] = useState('');
            const [showSlashMenu, setShowSlashMenu] = useState(false);
            const [isRecording, setIsRecording] = useState(false);
            const textareaRef = useRef(null);
            
            const slashCommands = [
                { command: '/summarize', description: 'Get a summary of the conversation' },
                { command: '/tone:casual', description: 'Switch to casual tone' },
                { command: '/tone:formal', description: 'Switch to formal tone' },
                { command: '/wipe', description: 'Start data wiping process' },
                { command: '/verify', description: 'Verify wiping completion' },
            ];
            
            useEffect(() => {
                if (message.startsWith('/')) {
                    setShowSlashMenu(true);
                } else {
                    setShowSlashMenu(false);
                }
            }, [message]);
            
            const handleSend = () => {
                if (message.trim()) {
                    onSend(message.trim());
                    setMessage('');
                    setShowSlashMenu(false);
                }
            };
            
            const handleKeyDown = (e) => {
                if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                    e.preventDefault();
                    handleSend();
                }
            };
            
            const handleCommandSelect = (command) => {
                setMessage(command + ' ');
                setShowSlashMenu(false);
                textareaRef.current?.focus();
            };
            
            return (
                <div className="relative">
                    {/* Slash Commands Menu */}
                    {showSlashMenu && (
                        <div className="absolute bottom-full mb-2 left-0 right-0 mx-4 glass-dark rounded-lg overflow-hidden">
                            {slashCommands
                                .filter(cmd => cmd.command.includes(message))
                                .map((cmd, index) => (
                                    <button
                                        key={index}
                                        onClick={() => handleCommandSelect(cmd.command)}
                                        className="w-full text-left px-4 py-3 hover:bg-white/10 transition-colors flex justify-between items-center"
                                    >
                                        <span className="text-purple-400 font-mono">{cmd.command}</span>
                                        <span className="text-gray-400 text-sm">{cmd.description}</span>
                                    </button>
                                ))}
                        </div>
                    )}
                    
                    <div className="flex items-end space-x-2 p-4">
                        {/* Attachment Button */}
                        <button className="p-3 rounded-lg glass hover:bg-white/10 text-gray-400 hover:text-white transition-all">
                            <Icon name="attachment" className="w-5 h-5" />
                        </button>
                        
                        {/* Message Input */}
                        <div className="flex-1 relative">
                            <textarea
                                ref={textareaRef}
                                value={message}
                                onChange={(e) => setMessage(e.target.value)}
                                onKeyDown={handleKeyDown}
                                placeholder="Type your message... (Use / for commands)"
                                className="w-full px-4 py-3 rounded-lg glass bg-white/5 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"
                                rows="1"
                                style={{ minHeight: '48px', maxHeight: '120px' }}
                            />
                        </div>
                        
                        {/* Emoji Button */}
                        <button className="p-3 rounded-lg glass hover:bg-white/10 text-gray-400 hover:text-white transition-all">
                            <Icon name="emoji" className="w-5 h-5" />
                        </button>
                        
                        {/* Send Button */}
                        <button
                            onClick={handleSend}
                            disabled={!message.trim()}
                            className={`p-3 rounded-lg transition-all ${
                                message.trim()
                                    ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 glow'
                                    : 'glass text-gray-500'
                            }`}
                        >
                            <Icon name="send" className="w-5 h-5" />
                        </button>
                    </div>
                </div>
            );
        };

        // Main Chat Window Component
        const ChatWindow = ({ conversationId }) => {
            const [messages, setMessages] = useState([
                { id: 1, content: "Welcome to Sayonara AI! 🚀 I'm here to help you with secure data wiping and IT asset recycling. How can I assist you today?", isUser: false, timestamp: new Date().toISOString() }
            ]);
            const [isTyping, setIsTyping] = useState(false);
            const [quickReplies] = useState([
                "Tell me about data wiping",
                "How does blockchain verification work?",
                "What are NIST standards?",
                "Start wiping process"
            ]);
            const messagesEndRef = useRef(null);
            
            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };
            
            useEffect(scrollToBottom, [messages]);
            
            const handleSendMessage = async (content) => {
                // Add user message
                const userMessage = {
                    id: Date.now(),
                    content,
                    isUser: true,
                    timestamp: new Date().toISOString()
                };
                setMessages(prev => [...prev, userMessage]);
                
                // Show typing indicator
                setIsTyping(true);
                
                // Simulate streaming response
                const tempId = Date.now() + 1;
                let streamedContent = '';
                
                const cleanup = api.streamMessage(conversationId, content, (chunk, done) => {
                    streamedContent = chunk;
                    if (!done) {
                        setMessages(prev => {
                            const existing = prev.find(m => m.id === tempId);
                            if (existing) {
                                return prev.map(m => m.id === tempId ? { ...m, content: chunk } : m);
                            } else {
                                return [...prev, { id: tempId, content: chunk, isUser: false, timestamp: new Date().toISOString() }];
                            }
                        });
                    } else {
                        setIsTyping(false);
                    }
                });
                
                // Cleanup on unmount
                return cleanup;
            };
            
            return (
                <div className="flex-1 flex flex-col h-full">
                    {/* Header */}
                    <div className="p-4 glass-dark border-b border-white/10">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-3">
                                <div className="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold">
                                    S
                                </div>
                                <div>
                                    <h3 className="font-semibold text-white">Sayonara AI Assistant</h3>
                                    <p className="text-xs text-gray-400 flex items-center">
                                        <span className="w-2 h-2 bg-green-500 rounded-full mr-1"></span>
                                        Online • RAG Enabled
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* Messages Area */}
                    <div className="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-4">
                        {messages.map(message => (
                            <Message key={message.id} message={message} isUser={message.isUser} />
                        ))}
                        {isTyping && (
                            <div className="flex justify-start">
                                <TypingIndicator />
                            </div>
                        )}
                        <div ref={messagesEndRef} />
                    </div>
                    
                    {/* Quick Replies */}
                    {messages.length === 1 && (
                        <QuickReplies replies={quickReplies} onSelect={handleSendMessage} />
                    )}
                    
                    {/* Composer */}
                    <Composer onSend={handleSendMessage} />
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [conversations, setConversations] = useState([]);
            const [selectedConversation, setSelectedConversation] = useState('c1');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [rightPanelOpen, setRightPanelOpen] = useState(false);
            
            useEffect(() => {
                // Load conversations
                api.getConversations().then(setConversations);
                
                // Keyboard shortcuts
                const handleKeyDown = (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                        e.preventDefault();
                        // Focus search
                        document.querySelector('input[type="text"]')?.focus();
                    }
                    if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                        e.preventDefault();
                        // New chat
                        console.log('New chat');
                    }
                    if (e.key === 'Escape') {
                        setSidebarOpen(false);
                        setRightPanelOpen(false);
                    }
                };
                
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, []);
            
            return (
                <ThemeProvider>
                    <div className="h-screen flex relative">
                        {/* Mobile Menu Button */}
                        <button
                            onClick={() => setSidebarOpen(true)}
                            className="lg:hidden fixed top-4 left-4 z-50 p-2 rounded-lg glass text-white"
                        >
                            <Icon name="menu" className="w-6 h-6" />
                        </button>
                        
                        {/* Settings Button */}
                        <button
                            onClick={() => setRightPanelOpen(!rightPanelOpen)}
                            className="fixed top-4 right-4 z-50 p-2 rounded-lg glass text-white"
                        >
                            <Icon name="settings" className="w-6 h-6" />
                        </button>
                        
                        {/* Sidebar */}
                        <Sidebar
                            conversations={conversations}
                            selectedId={selectedConversation}
                            onSelectConversation={setSelectedConversation}
                            isOpen={sidebarOpen}
                            onClose={() => setSidebarOpen(false)}
                        />
                        
                        {/* Main Chat Area */}
                        <div className="flex-1 flex">
                            <ChatWindow conversationId={selectedConversation} />
                        </div>
                        
                        {/* Right Panel */}
                        <RightPanel
                            isOpen={rightPanelOpen}
                            onClose={() => setRightPanelOpen(false)}
                        />
                        
                        {/* Overlay for mobile */}
                        {(sidebarOpen || rightPanelOpen) && (
                            <div
                                className="lg:hidden fixed inset-0 bg-black/50 z-30"
                                onClick={() => {
                                    setSidebarOpen(false);
                                    setRightPanelOpen(false);
                                }}
                            />
                        )}
                    </div>
                </ThemeProvider>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>